
Import('env')

#TODO move to normal debug\release modes

#debugcflags = ['-W1', '-GX', '-EHsc', '-D_DEBUG', '/MDd']   #extra compile flags for debug
#releasecflags = ['-O2', '-EHsc', '-DNDEBUG', '/MD']         #extra compile flags for release
#env.Append(CCFLAGS='-g')

#env = default_env.Clone()

#Configure environment to create ccdb_library

lib_target  = "ccdb"
lib_sources = [
    
    #some global objects    
	"Console.cc",
	"Log.cc",
	"CCDBError.cc",
	"GlobalMutex.cc",
	"IMutex.cc",
	"ISyncObject.cc",
	"PthreadMutex.cc",
	"PthreadSyncObject.cc",
	
	#user api
	"Calibration.cc",
	"CalibrationGenerator.cc",
	"MySQLCalibration.cc",
    "SQLiteCalibration.cc",
	
	#helper classes
	"Helpers/StringUtils.cc",
	"Helpers/PathUtils.cc",
	"Helpers/WorkUtils.cc",
	
	#model and provider
	"Model/ObjectsOwner.cc",
	"Model/StoredObject.cc",
	"Model/Assignment.cc",
	"Model/ConstantsTypeColumn.cc",
	"Model/ConstantsTypeTable.cc",
	"Model/Directory.cc",
	"Model/EventRange.cc",
	"Model/RunRange.cc",
	"Model/Variation.cc",
	"Providers/DataProvider.cc",
	"Providers/FileDataProvider.cc",
	"Providers/MySQLConnectionInfo.cc",
	"Providers/MySQLDataProvider.cc",
    "Providers/SQLiteDataProvider.cc",
	"Providers/IAuthentication.cc",
	"Providers/EnvironmentAuthentication.cc",
    
    #sqlite embedding
    "#src/SQLite/sqlite3.c"
	]

env.ParseConfig('mysql_config --libs --cflags')

#Making library
lib = env.SharedLibrary(target = lib_target, source = lib_sources)
env.Install('#lib', lib)

static_lib = env.StaticLibrary(target = lib_target, source = lib_sources)
env.Install('#lib', static_lib)
